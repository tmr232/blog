<!doctype html><html lang=en>
<head>
<title>Adventures in Rust - tamir.dev</title>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<meta name=description content="The HTML5 Herald">
<meta name=author content="Tamir Bahar"><meta property="og:title" content="Adventures in Rust">
<meta property="og:description" content="A tale of my time in Rust-land">
<meta property="og:type" content="article">
<meta property="og:url" content="https://www.tamir.dev/posts/adventures-in-rust/"><meta property="article:section" content="posts">
<meta property="article:published_time" content="2018-04-27T00:00:00+00:00">
<meta property="article:modified_time" content="2018-04-27T00:00:00+00:00">
<meta name=twitter:card content="summary">
<meta name=twitter:title content="Adventures in Rust">
<meta name=twitter:description content="A tale of my time in Rust-land">
<meta name=generator content="Hugo 0.89.0">
<link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.min.css integrity="sha256-l85OmPOjvil/SOvVt3HnSSjzF1TUMyT9eV0c2BzEGzU=" crossorigin=anonymous>
<link rel=stylesheet href=https://www.tamir.dev/fontawesome/css/all.min.css>
<link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto+Slab|Ruda">
<link rel=stylesheet type=text/css href=https://www.tamir.dev/css/styles.css></head>
<body>
<div id=container>
<header>
<h1>
<a href=https://www.tamir.dev/>tamir.dev</a>
</h1>
<ul id=social-media>
<li>
<a href=https://github.com/tmr232 title=GitHub>
<i class="fab fa-github fa-lg"></i>
</a>
</li>
<li>
<a href=https://twitter.com/tmr232 title=Twitter>
<i class="fab fa-twitter fa-lg"></i>
</a>
</li>
<li>
<a href=https://stackoverflow.com/users/3337893/tmr232 title=StackOverflow>
<i class="fab fa-stack-overflow fa-lg"></i>
</a>
</li>
<li>
<a href=https://dev.to/tmr232 title=devto>
<i class="fab fa-dev fa-lg"></i>
</a>
</li>
</ul>
</header>
<nav>
<ul>
</ul>
</nav>
<main>
<article>
<h1>Adventures in Rust</h1>
<aside>
<ul>
<li>
<time class=post-date datetime=2018-04-27T00:00:00Z>Apr 27, 2018</time>
</li>
<li>5 minute read</li>
</ul>
</aside>
<p>In the few years since Rust came out, I&rsquo;ve frequently found myself explaining what an amazing language Rust is. Laying out the ways in which it is going to change the systems-programming world, and what a pleasure Rust is to code in.</p>
<p>A few months back, I finally got around to trying it out. It was horrid. The darned borrow-checker just wouldn&rsquo;t let me do anything. I couldn&rsquo;t get anything meaningful to compile. Despite years of programming in various languages I felt completely incompetent to handle it. I resolved to drop Rust and focus on other things.</p>
<p>Despite my initial disappointment and discouragement, I still could not get Rust out of my head. Its premise is too promising to put down after one go. Besides, I cannot be beaten by a programming language! And yet, it can wait. It is too much work for now. Some day, maybe in a few years, I&rsquo;ll write Rust.</p>
<p>Using Rust, however, is a completely different experience. Rust tools are absolutely amazing. As a Windows user through-and-through I got used to open-source tools (especially command line tools) not being supported on Windows. (No, cygwin is not a valid solution.) I don&rsquo;t blame the devs - they work on Linux. Even if they have the time to spend on the Windows port, they don&rsquo;t necessarily have a Windows machine to test it on. And yet - I am used to being disappointed. That is why, when I first heard of <a href=https://github.com/BurntSushi/ripgrep><code>rg</code></a>(an amazing <code>grep</code> replacement) and <a href=https://github.com/sharkdp/fd><code>fd</code></a>(an amazing <code>find</code> replacement) I <em>knew</em> that they would not work on Windows. But, being my optimistic self - I checked. And a good thing I did that.</p>
<p>To install Rust tools, the easiest way is to install the Rust toolset and compile them. A daunting task in every other language, yet a breeze in Rust.</p>
<ol>
<li>Head over to <a href=https://rustup.rs/>rustup.rs</a> and install Rust
(A single command-line on Linux, a single executable on Windows)</li>
<li><code>cargo install ripgrep fd-find</code></li>
<li>That&rsquo;s it. Really. Now use the tools.</li>
</ol>
<p>This was when I realized how amazing Rust really is. Even if you ignore the language completely - it&rsquo;s tooling and package management is unparalleled. Having published Python packages in the past, I was amazed at the simple publishing and installation mechanisms. Having used C and C++ I was simply amazed at a systems-programming with package management. So while still somewhat scared of the borrow-checker, I decided that my next CLI tool will be written in Rust. The easy-as-pie deployment bought be over completely.</p>
<p>Some months after that, I finally found myself in need of a new CLI tool. I was faced with a continuous log I wanted to filter for duplicates. <code>sort -u</code> sorts, so it cannot work on streams. Of course, there is probably some <code>sed</code> or <code>awk</code> magic I can use, but I want something simple. Besides, a tool that filters out duplicates seems like the perfect beginner project for getting hands-on with Rust. So I went ahead and creates <a href=https://crates.io/crates/uq><code>uq</code></a>. After finishing it, I published it on <a href=https://crates.io/>crates.io</a>. <code>cargo install uq</code> on a second machine, and it worked. Both Windows and Linux. A friend tried it, and it simply worked! I never had such a pleasant deployment experience. It is practically easier to install from source then send a compiled binary! And it works cross-platform out of the box.</p>
<p>A short while later I wanted to group some log entries by a regex. I looked around and could not find a simple way to do it. So, once again, I turned to Rust. Some borrow-checker-wrestling later and the first version of <a href=https://crates.io/crates/groupby><code>groupby</code></a> was complete. Yay!</p>
<p>A short time later I had one of the best open-source experiences I&rsquo;ve ever had. Someone started using <code>groupby</code>, looked at my terrible code, and posted <a href=https://github.com/lostutils/groupby/issues/1>this issue</a>:</p>
<blockquote>
<p>Hello</p>
<p>I find this little program will be useful for many things I do (I usually do something like that with combination of sed, sort, …). I also looked into the code. Do I guess right that you&rsquo;re still learning Rust? Could I provide few little tips?</p>
<p>I glimpsed at least one unwrap that can be triggered by the user input (giving a too large group ID), which will result in ugly error message instead of nice useful one.
Do you choose BTreeMap/BTreeSet for some specific reason? Is it the order of elements? If not, HashMap and HashSet are likely to be faster.
Both variants (unique vs all) look very similar and differ only in the inner data type and the method used to push/insert. I think this could be done with just one piece of code that is generic over the type, and adding your own trait that implements the adding for either. Would you like me to show you such code?</p>
</blockquote>
<p>Having someone more experienced in Rust come in and help me improve my very naïve code was great. And it was my first time getting a &ldquo;this is great, may I help you?&rdquo; comment and not a &ldquo;this is great, I want this as well&rdquo; one.</p>
<p>For the time being, I keep spending more time wrestling the borrow-checker than writing actual code in Rust. But I am (almost) sure it is due to lack of experience. On the plus-side, I&rsquo;m becoming better at detecting lifetime issues in other languages as well.</p>
<p>So, for anyone who hasn&rsquo;t done it yet, I highly recommend using Rust-based tools. Just for the amazing experience of things working (and compiling!) out of the box. Later, if you choose to actually code in it, be sure to brace yourself for a somewhat bumpy ride. Friends tell me that after a time Rust becomes easier, speeding up their development. I&rsquo;m not there yet, but I&rsquo;m working on it.</p>
</article>
<section class=post-nav>
<ul>
<li>
<a href=https://www.tamir.dev/posts/types-of-loops/><i class="fa fa-chevron-circle-left"></i> Types of Loops</a>
</li>
<li>
<a href=https://www.tamir.dev/posts/working-across-timezones/>Working Across Time-Zones <i class="fa fa-chevron-circle-right"></i> </a>
</li>
</ul>
</section>
</main>
<footer>
<ul>
<li>
<h6>Copyright © 2021 - Tamir Bahar |
Rendered by <a href=https://gohugo.io title=Hugo>Hugo</a> |
<a href=https://www.tamir.dev/index.xml>Subscribe </a></h6>
</li>
</ul>
</footer>
</div>
<script src=https://www.tamir.dev/js/scripts.js></script>
</body>
</html>